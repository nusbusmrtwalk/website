---
import type { CollectionEntry } from "astro:content";
import FormattedDate from "../FormattedDate.astro";
import { Image } from "astro:assets";

interface Props {
  events: CollectionEntry<"events">[];
}

const { events } = Astro.props;
---

<ul class="eventlist">
  {
    events.map((event) => (
      <li>
        <a href={`/events/${event.id}`}>
          <Image
            src={event.data.heroImage}
            alt={`Thumbnail for ${event.data.title}`}
            width={240}
            height={180}
          />
          <div class="info">
            <h3 class="title">{event.data.title}</h3>
            <p class="description">{event.data.description}</p>
            <div class="details">
              <div class="location">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-map-pin"
                >
                  <>
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M9 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" />
                    <path d="M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0" />
                  </>
                </svg>
                <span>{event.data.eventLocationName}</span>
              </div>
              <div class="time">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-clock-hour-3"
                >
                  <>
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M3 12a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                    <path d="M12 12h3.5" />
                    <path d="M12 7v5" />
                  </>
                </svg>
                <span>
                  <FormattedDate date={event.data.eventDateTime} />
                </span>
              </div>
            </div>
          </div>
        </a>
      </li>
    ))
  }
</ul>

<style>
  .eventlist {
    list-style: none;
    padding-left: 0;
    margin-top: 0;
  }

  .eventlist li {
    margin-bottom: 0.5rem;
    border: solid 1px var(--color-track-gray-200);
    border-radius: 0.5rem;
    transition: background-color 0.2s ease-in-out;
    display: flex;
    overflow: hidden;

    &:hover {
      background-color: var(--color-track-gray-100);
    }
  }

  a {
    flex-grow: 1;
    display: flex;
    text-decoration: none;
    color: inherit;
    align-items: center;
    min-width: 0;
  }

  a img {
    width: 160px !important;
    height: 120px !important;
    aspect-ratio: 4/3;
    object-fit: cover;
    border-radius: 0;
  }

  .info {
    flex: 1;
    min-width: 0;
    flex-basis: 0;
    padding: 1rem 1.5rem;
  }

  .title {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-track-gray-900);
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    min-width: 0;
  }
  .description {
    margin: 0.25rem 0 0;
    color: var(--color-track-gray-600);
    font-size: 1rem;
    /* clamp to one line; use ellipses if too long */
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
    min-width: 0;
  }
  .details {
    display: flex;
    gap: 1.5rem;
    font-size: 0.875rem;
    color: var(--color-track-gray-400);
    margin: 0.5rem 0 0;
  }
  .location,
  .time {
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }
  .icon {
    width: 1rem;
    height: 1rem;
  }
</style>
